{% extends "bamzi/base.html" %}
{% load static %}

{% block title %}سهام من{% endblock %}

{% block header_css %}{% endblock %}

{% block active_menu %}
<li>
    <a class="active-menu" href="index.html"><i class="fa fa-dashboard"></i> سهام من</a>
</li>
<li>
    <a href="ui-elements.html"><i class="fa fa-desktop"></i> حق تقدم‌ها</a>
</li>
<li>
    <a href="chart.html"><i class="fa fa-bar-chart-o"></i> Charts</a>
</li>
<li>
    <a href="tab-panel.html"><i class="fa fa-qrcode"></i> Tabs & Panels</a>
</li>

<li>
    <a href="table.html"><i class="fa fa-table"></i> Responsive Tables</a>
</li>
<li>
    <a href="form.html"><i class="fa fa-edit"></i> Forms </a>
</li>


<li>
    <a href="#"><i class="fa fa-sitemap"></i> Multi-Level Dropdown<span class="fa arrow"></span></a>
    <ul class="nav nav-second-level">
        <li>
            <a href="#">Second Level Link</a>
        </li>
        <li>
            <a href="#">Second Level Link</a>
        </li>
        <li>
            <a href="#">Second Level Link<span class="fa arrow"></span></a>
            <ul class="nav nav-third-level">
                <li>
                    <a href="#">Third Level Link</a>
                </li>
                <li>
                    <a href="#">Third Level Link</a>
                </li>
                <li>
                    <a href="#">Third Level Link</a>
                </li>

            </ul>

        </li>
    </ul>
</li>
<li>
    <a href="empty.html"><i class="fa fa-fw fa-file"></i> Empty Page</a>
</li>
{% endblock %}

{% block page_header %}داشبورد{% endblock %}

{% block page_header_small %}سهام من{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                افزودن سهم
            </div>
            <div class="panel-body">
                <div class="row">
                    <form role="form" action="{% url 'my_shares' username=request.user.username %}" method="POST">
                    {% csrf_token %}
                        <div class="form-group col-lg-6">
                            <label>سهم</label>
                            <input class="form-control" id="share_name" required>
                            <input class="hide" id="share_id" name="share_id" required>
                            <span class="glyphicon glyphicon-remove d-none" id="remove_share"></span>
                        </div>
                        <div class="form-group col-lg-6">
                            <label>قیمت سربه‌سر</label>
                            <input class="form-control" placeholder="به ریال" name="basic_price" required>
                        </div>
                        <div class="form-group col-lg-6">
                            <label>تعداد</label>
                            <input class="form-control" type="number" name="count" required>
                        </div>
                        {% comment %} <div class="form-group col-lg-6">
                            <label>تاریخ خرید</label>
                            <input class="form-control" type="date">
                        </div> {% endcomment %}
                        <div class="col-md-12">
                            <button type="submit" class="btn btn-primary col-md-3">ثبت</button>
                        </div>
                    </form>
                </div>
                <!-- /.row (nested) -->
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <!-- Advanced Tables -->
        <div class="panel panel-default">
            <div class="panel-heading">
                    سهام من
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                        <thead>
                            <tr>
                                <th>سهم</th>
                                <th>شرکت</th>
                                <th>سربه‌سر</th>
                                <th>آخرین قیمت</th>
                                <th>قیمت پایانی</th>
                                <th>تعداد</th>
                                <th>وضعیت</th>
                                <th>سود / ضرر</th>
                                <th>درصد هدف</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for share in user_shares %}
                                <tr class="odd gradeA">
                                    <td>{{share.symbol_name}}</td>
                                    <td>{{share.company_name}}</td>
                                    <td>{{share.basic_price}}</td>
                                    <td>{{share.last_price}}</td>
                                    <td>{{share.final_price}}</td>
                                    <td>{{share.count}}</td>
                                    <td>9</td>
                                    <td>{{share.profit_loss}}</td>
                                    <td>5</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
        <!--End Advanced Tables -->
    </div>
</div>

{% endblock %}

{% block footer_js %}
    <!-- Custom Js -->

    <script src="{% static 'bamzi/js/dataTables/jquery.dataTables.js' %}" ></script>
    <script src="{% static 'bamzi/js/dataTables/dataTables.bootstrap.js' %}" ></script>
    <script>
        $(document).ready(function () {
            $('#dataTables-example').dataTable();

            $(function() {
                $("#share_name").autocomplete({
                    source: '/bamzi/shares-name/',
                    select: function (event, ui) { //item selected
                        AutoCompleteSelectHandlerShop(event, ui)
                    },
                    minLength: 2,
                });
            });

            function AutoCompleteSelectHandlerShop(event, ui){
                var selectedObj = ui.item;
                $("#remove_share").show();
                if(selectedObj.id){
                    $("#share_name").attr("data-share", selectedObj.id);
                    $("#share_id").val(selectedObj.id);
                }
                else{
                    $("#share_name").attr("data-share", "");
                    $("#share_id").val("");
                }
                var selectedObj = ui.item;
            }
            $("#remove_share").click(function(){
                $("#share_name").val('');
                $("#share_name").attr("data-share", "");
                $("#remove_share").hide();
            });
        });
    </script>
    {% comment %} <script src="{% static 'bamzi/js/custom-scripts.js' %}"></script> {% endcomment %}
{% endblock %}
