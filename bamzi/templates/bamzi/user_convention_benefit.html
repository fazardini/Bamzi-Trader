{% extends "bamzi/base.html" %}
{% load static %}
{% load jalali_tags %}

{% block title %} سود مجامع من{% endblock %}

{% block header_css %}{% endblock %}

{% block active_menu %}
<li>
    <a href="{% url 'my_shares' username=request.user.username %}"><i class="fa fa-dashboard"></i> سهام من</a>
</li>
<li>
    <a href="{% url 'share_convention' %}"><i class="fa fa-bar-chart-o"></i> افزایش سرمایه‌ها</a>
</li>
<li>
    <a href="{% url 'my_precedence_shares' username=request.user.username %}"><i class="fa fa-desktop"></i> حق تقدم‌های من</a>
</li>
<li>
    <a class="active-menu" href="{% url 'my_convention_benefit' username=request.user.username %}"><i class="fa fa-table"></i> سود مجامع</a>
</li>
<li>
    <a href="{% url 'my_industry' username=request.user.username %}"><i class="fa fa-sitemap"></i> صنایع من</a>
</li>
<li>
    <a href="tab-panel.html"><i class="fa fa-qrcode"></i> سهام مناسب خرید</a>
</li>
<li>
    <a href="#"><i class="fa fa-sitemap"></i> Multi-Level Dropdown<span class="fa arrow"></span></a>
</li>
<li>
    <a href="empty.html"><i class="fa fa-fw fa-file"></i> Empty Page</a>
</li>
{% endblock %}

{% block page_header %}سود مجامع من{% endblock %}

{% comment %} {% block page_header_small %}سهام من{% endblock %} {% endcomment %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                افزودن سود مجمع
            </div>
            <div class="panel-body">
                <div class="row">
                    <form role="form" action="{% url 'my_convention_benefit' username=request.user.username %}" method="POST">
                    {% csrf_token %}
                        <div class="form-group col-lg-6">
                            <label>سهم</label>
                            <input class="form-control" id="share_name" required>
                            <input class="hide" id="share_id" name="share_id" required>
                            <span class="glyphicon glyphicon-remove d-none" id="remove_share"></span>
                        </div>
                        <div class="form-group col-lg-6">
                            <label>مبلغ سود</label>
                            <input class="form-control" name="benefit_price" required>
                        </div>
                        <div class="col-md-12">
                            <button type="submit" class="btn btn-primary col-md-3">ثبت</button>
                        </div>
                    </form>
                </div>
                <!-- /.row (nested) -->
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <!-- Advanced Tables -->
        <div class="panel panel-default">
            <div class="panel-heading">
                    سود مجامع من
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                        <thead>
                            <tr>
                                <th>سهم</th>
                                <th>مبلغ سود</th>
                                <th>از تاریخ</th>
                                <th>تا تاریخ</th>
                                <th>بانک</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for share in user_convention_benefits %}
                                <tr class="odd gradeA">
                                    <td><i class="fa fa-square text {% if share.is_open %}text-success{% else %}text-danger{% endif %}"></i>
                                     {{share.symbol_name}}</td>
                                    <td>{{share.benefit_price}}</td>
                                    <td>{{share.from_date|to_jalali:'%y/%m/%d'}}</td>
                                    <td>{{share.to_date|to_jalali:'%y/%m/%d'}}</td>
                                    <td>{{share.bank}}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
        <!--End Advanced Tables -->
    </div>
</div>

{% endblock %}

{% block footer_js %}
    <!-- Custom Js -->

    <script src="{% static 'bamzi/js/dataTables/jquery.dataTables.js' %}" ></script>
    <script src="{% static 'bamzi/js/dataTables/dataTables.bootstrap.js' %}" ></script>
    <script>
        $(document).ready(function () {
            $('#dataTables-example').dataTable();

            $(function() {
                $("#share_name").autocomplete({
                    source: '/bamzi/convention-benefit-name/',
                    select: function (event, ui) { //item selected
                        AutoCompleteSelectHandlerShop(event, ui)
                    },
                    minLength: 2,
                });
            });

            function AutoCompleteSelectHandlerShop(event, ui){
                var selectedObj = ui.item;
                $("#remove_share").show();
                if(selectedObj.id){
                    $("#share_name").attr("data-share", selectedObj.id);
                    $("#share_id").val(selectedObj.id);
                }
                else{
                    $("#share_name").attr("data-share", "");
                    $("#share_id").val("");
                }
                var selectedObj = ui.item;
            }
            $("#remove_share").click(function(){
                $("#share_name").val('');
                $("#share_name").attr("data-share", "");
                $("#remove_share").hide();
            });
        });
    </script>
{% endblock %}
